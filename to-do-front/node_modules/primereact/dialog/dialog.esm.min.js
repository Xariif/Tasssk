import*as e from"react";import t from"primereact/api";import{CSSTransition as n}from"primereact/csstransition";import{useEventListener as r,useMountEffect as o,useUpdateEffect as a,useUnmountEffect as l}from"primereact/hooks";import{Portal as i}from"primereact/portal";import{Ripple as c}from"primereact/ripple";import{DomHandler as u,UniqueComponentId as s,ZIndexUtils as m,ObjectUtils as d,classNames as p}from"primereact/utils";function f(){return f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(e){if(Array.isArray(e))return g(e)}function y(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function h(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}function v(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w(e){if(Array.isArray(e))return e}function E(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],l=!0,i=!1;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);l=!0);}catch(e){i=!0,o=e}finally{try{l||null==n.return||n.return()}finally{if(i)throw o}}return a}}function S(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x(e,t){return w(e)||E(e,t)||h(e,t)||S()}var k=e.forwardRef((function(g,w){var E=x(e.useState(g.id),2),S=E[0],z=E[1],C=x(e.useState(!1),2),D=C[0],R=C[1],I=x(e.useState(!1),2),N=I[0],O=I[1],P=x(e.useState(g.maximized),2),M=P[0],X=P[1],H=e.useRef(null),A=e.useRef(null),Y=e.useRef(null),T=e.useRef(null),j=e.useRef(null),B=e.useRef(null),_=e.useRef(!1),V=e.useRef(!1),J=e.useRef(null),L=e.useRef(null),W=e.useRef(null),Z=e.useRef(""),F=g.onMaximize?g.maximized:M,K=x(r({type:"keydown",listener:function(e){return de(e)}}),2),$=K[0],U=K[1],q=x(r({type:"mousemove",target:function(){return window.document},listener:function(e){return he(e)}}),2),G=q[0],Q=q[1],ee=x(r({type:"mouseup",target:function(){return window.document},listener:function(e){return ve(e)}}),2),te=ee[0],ne=ee[1],re=x(r({type:"mousemove",target:function(){return window.document},listener:function(e){return fe(e)}}),2),oe=re[0],ae=re[1],le=x(r({type:"mouseup",target:function(){return window.document},listener:function(e){return ge(e)}}),2),ie=le[0],ce=le[1],ue=function(e){g.onHide(),e.preventDefault()},se=function(e){g.dismissableMask&&g.modal&&A.current===e.target&&ue(e),g.onMaskClick&&g.onMaskClick(e)},me=function(e){g.onMaximize?g.onMaximize({originalEvent:e,maximized:!F}):X((function(e){return!e})),e.preventDefault()},de=function(e){var t=e.currentTarget;if(t&&t.primeDialogParams){var n=t.primeDialogParams,r=n.length,o=n[r-1]?n[r-1].id:void 0;if(o===S&&g.closeOnEscape){var a=document.getElementById(o);if(27===e.which)ue(e),e.stopImmediatePropagation(),n.splice(r-1,1);else if(9===e.which){e.preventDefault();var l=u.getFocusableElements(a);if(l&&l.length>0)if(document.activeElement){var i=l.indexOf(document.activeElement);e.shiftKey?-1===i||0===i?l[l.length-1].focus():l[i-1].focus():-1===i||i===l.length-1?l[0].focus():l[i+1].focus()}else l[0].focus()}}}},pe=function(e){u.hasClass(e.target,"p-dialog-header-icon")||u.hasClass(e.target.parentElement,"p-dialog-header-icon")||g.draggable&&(_.current=!0,J.current=e.pageX,L.current=e.pageY,H.current.style.margin="0",u.addClass(document.body,"p-unselectable-text"),g.onDragStart&&g.onDragStart(e))},fe=function(e){if(_.current){var t=u.getOuterWidth(H.current),n=u.getOuterHeight(H.current),r=e.pageX-J.current,o=e.pageY-L.current,a=H.current.getBoundingClientRect(),l=a.left+r,i=a.top+o,c=u.getViewport();H.current.style.position="fixed",g.keepInViewport?(l>=g.minX&&l+t<c.width&&(J.current=e.pageX,H.current.style.left=l+"px"),i>=g.minY&&i+n<c.height&&(L.current=e.pageY,H.current.style.top=i+"px")):(J.current=e.pageX,H.current.style.left=l+"px",L.current=e.pageY,H.current.style.top=i+"px"),g.onDrag&&g.onDrag(e)}},ge=function(e){_.current&&(_.current=!1,u.removeClass(document.body,"p-unselectable-text"),g.onDragEnd&&g.onDragEnd(e))},be=function(e){g.resizable&&(V.current=!0,J.current=e.pageX,L.current=e.pageY,u.addClass(document.body,"p-unselectable-text"),g.onResizeStart&&g.onResizeStart(e))},ye=function(e,t,n){!n&&(n=u.getViewport());var r=parseInt(e);return/^(\d+|(\.\d+))(\.\d+)?%$/.test(e)?r*(n[t]/100):r},he=function(e){if(V.current){var t=e.pageX-J.current,n=e.pageY-L.current,r=u.getOuterWidth(H.current),o=u.getOuterHeight(H.current),a=H.current.getBoundingClientRect(),l=u.getViewport(),i=!parseInt(H.current.style.top)||!parseInt(H.current.style.left),c=ye(H.current.style.minWidth,"width",l),s=ye(H.current.style.minHeight,"height",l),m=r+t,d=o+n;i&&(m+=t,d+=n),(!c||m>c)&&a.left+m<l.width&&(H.current.style.width=m+"px"),(!s||d>s)&&a.top+d<l.height&&(H.current.style.height=d+"px"),J.current=e.pageX,L.current=e.pageY,g.onResize&&g.onResize(e)}},ve=function(e){V.current&&(V.current=!1,u.removeClass(document.body,"p-unselectable-text"),g.onResizeEnd&&g.onResizeEnd(e))},we=function(){H.current.style.position="",H.current.style.left="",H.current.style.top="",H.current.style.margin=""},Ee=function(){H.current.setAttribute(Z.current,"")},Se=function(){var e;g.onShow&&g.onShow(),g.focusOnShow&&!((e=document.activeElement)&&H.current&&H.current.contains(e))&&g.closable&&g.showHeader&&B.current.focus(),ze()},xe=function(){g.modal&&u.addClass(A.current,"p-component-overlay-leave"),g.blockScroll&&u.removeClass(document.body,"p-overflow-hidden")},ke=function(){_.current=!1,m.clear(A.current),R(!1),Ce()},ze=function(){De(),(g.blockScroll||g.maximizable&&F)&&u.addClass(document.body,"p-overflow-hidden")},Ce=function(){(Re(),g.modal)?document.primeDialogParams&&document.primeDialogParams.some((function(e){return e.hasBlockScroll}))&&u.removeClass(document.body,"p-overflow-hidden"):(g.blockScroll||g.maximizable&&F)&&u.removeClass(document.body,"p-overflow-hidden")},De=function(){if(g.draggable&&(oe(),ie()),g.resizable&&(G(),te()),g.closable){$();var e={id:S,hasBlockScroll:g.blockScroll};document.primeDialogParams=document.primeDialogParams?[].concat(b(t=document.primeDialogParams)||y(t)||h(t)||v(),[e]):[e]}var t},Re=function(){ae(),ce(),Q(),ne(),U(),document.primeDialogParams=document.primeDialogParams&&document.primeDialogParams.filter((function(e){return e.id!==S}))},Ie=function(){if(!W.current){W.current=u.createInlineStyle(t.nonce);var e="";for(var n in g.breakpoints)e+="\n                    @media screen and (max-width: ".concat(n,") {\n                        .p-dialog[").concat(Z.current,"] {\n                            width: ").concat(g.breakpoints[n]," !important;\n                        }\n                    }\n                ");W.current.innerHTML=e}};o((function(){var e=s();S||z(e),Z.current||(Z.current=e),g.visible&&R(!0),g.breakpoints&&Ie()})),a((function(){g.visible&&!D&&R(!0),g.visible!==N&&D&&O(g.visible)})),a((function(){D&&(m.set("modal",A.current,t.autoZIndex,g.baseZIndex||t.zIndex.modal),O(!0))}),[D]),a((function(){g.blockScroll||u[F?"addClass":"removeClass"](document.body,"p-overflow-hidden")}),[g.maximized,M]),l((function(){Ce(),u.removeInlineStyle(W.current),m.clear(A.current)})),e.useImperativeHandle(w,(function(){return{props:g,resetPosition:we,getElement:function(){return H.current},getMask:function(){return A.current},getContent:function(){return Y.current},getHeader:function(){return T.current},getFooter:function(){return j.current},getCloseButton:function(){return B.current}}}));var Ne,Oe,Pe,Me,Xe,He,Ae,Ye,Te,je=function(){if(g.showHeader){var t=g.closable?e.createElement("button",{ref:B,type:"button",className:"p-dialog-header-icon p-dialog-header-close p-link","aria-label":g.ariaCloseIconLabel,onClick:ue},e.createElement("span",{className:"p-dialog-header-close-icon pi pi-times"}),e.createElement(c,null)):null,n=(i=p("p-dialog-header-maximize-icon pi",{"pi-window-maximize":!F,"pi-window-minimize":F}),g.maximizable?e.createElement("button",{type:"button",className:"p-dialog-header-icon p-dialog-header-maximize p-link",onClick:me},e.createElement("span",{className:i}),e.createElement(c,null)):null),r=d.getJSXElement(g.icons,g),o=d.getJSXElement(g.header,g),a=S+"_header",l=p("p-dialog-header",g.headerClassName);return e.createElement("div",{ref:T,style:g.headerStyle,className:l,onMouseDown:pe},e.createElement("div",{id:a,className:"p-dialog-title"},o),e.createElement("div",{className:"p-dialog-header-icons"},r,n,t))}var i;return null},Be=function(){var t=p("p-dialog-content",g.contentClassName);return e.createElement("div",{id:S+"_content",ref:Y,className:t,style:g.contentStyle},g.children)},_e=function(){var t=d.getJSXElement(g.footer,g);return t&&e.createElement("div",{ref:j,className:"p-dialog-footer"},t)};return D&&(Oe=d.findDiffKeys(g,k.defaultProps),Pe=p("p-dialog p-component",g.className,{"p-dialog-rtl":g.rtl,"p-dialog-maximized":F}),Me=p("p-dialog-mask",(Ne=["center","left","right","top","top-left","top-right","bottom","bottom-left","bottom-right"].find((function(e){return e===g.position||e.replace("-","")===g.position})))?"p-dialog-".concat(Ne):"",{"p-component-overlay p-component-overlay-enter":g.modal,"p-dialog-visible":D,"p-dialog-draggable":g.draggable,"p-dialog-resizable":g.resizable},g.maskClassName),Xe=je(),He=Be(),Ae=_e(),Ye=g.resizable?e.createElement("span",{className:"p-resizable-handle",style:{zIndex:90},onMouseDown:be}):null,Te=e.createElement("div",{ref:A,style:g.maskStyle,className:Me,onClick:se},e.createElement(n,{nodeRef:H,classNames:"p-dialog",timeout:{enter:"center"===g.position?150:300,exit:"center"===g.position?150:300},in:N,options:g.transitionOptions,unmountOnExit:!0,onEnter:Ee,onEntered:Se,onExiting:xe,onExited:ke},e.createElement("div",f({ref:H,id:S,className:Pe,style:g.style,onClick:g.onClick,role:"dialog"},Oe,{"aria-labelledby":S+"_header","aria-describedby":S+"_content","aria-modal":g.modal}),Xe,He,Ae,Ye))),e.createElement(i,{element:Te,appendTo:g.appendTo,visible:!0}))}));k.displayName="Dialog",k.defaultProps={__TYPE:"Dialog",id:null,header:null,footer:null,visible:!1,position:"center",draggable:!0,resizable:!0,modal:!0,onHide:null,onShow:null,headerStyle:null,headerClassName:null,contentStyle:null,contentClassName:null,closeOnEscape:!0,dismissableMask:!1,rtl:!1,closable:!0,style:null,className:null,maskStyle:null,maskClassName:null,showHeader:!0,appendTo:null,baseZIndex:0,maximizable:!1,blockScroll:!1,icons:null,ariaCloseIconLabel:"Close",focusOnShow:!0,minX:0,minY:0,keepInViewport:!0,maximized:!1,breakpoints:null,transitionOptions:null,onMaximize:null,onDragStart:null,onDrag:null,onDragEnd:null,onResizeStart:null,onResize:null,onResizeEnd:null,onClick:null,onMaskClick:null};export{k as Dialog};
